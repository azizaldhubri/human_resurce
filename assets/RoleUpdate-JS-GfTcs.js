import{u as T,r as o,j as e,N as E,K as z,O as B,Q as D,V as H,x as k,w as r,X as $,A as l}from"./index-CxioH5k5.js";function V(){const{id:i}=T(),[m,R]=o.useState([]),[d,b]=o.useState(""),[p,x]=o.useState({}),[g,_]=o.useState(""),[y,v]=o.useState(!0),[f,S]=o.useState(!0);o.useEffect(()=>{const s=async()=>{const t=await l.get("pages");R(t.data)},a=async()=>{const t=await l.get(`rolesName/${i}`);_(t.data.name)},n=async()=>{const t=await l.get(`roles/${i}`),c={};t.data.forEach(C=>{c[C.page_id]=C}),x(c)};s(),a(),n()},[d]);const j=(s,a)=>{x(n=>{const t={...n};return t[s]||(t[s]={}),t[s][a]=!t[s][a],t})},w=(s,a)=>{x(n=>{const t={};return m.forEach(c=>{t[c.id]={...n[c.id],[a]:s?1:0}}),t})},P=async()=>{try{await l.post("roles/update-permissions",{role_id:i,permissions:p}),alert("Permissions updated successfully"),window.location.pathname=`dashboard/Role/RoleUpdate/${i}`}catch(s){console.error("Error updating permissions:",s)}},h={fontSize:"18px",fontWeight:"bold",borderRight:"2px solid black",backgroundColor:"#d3d9db",borderColor:"#c2c5c5",borderBottom:"3px solid gray",textAlign:"center"},u={fontSize:"19px",borderRight:"2px solid black",borderColor:"#c2c5c5",borderBottom:"3px solid gray",textAlign:"center",padding:"8px"};async function A(s){s.preventDefault();const a=new FormData;a.append("name",d);try{await l.post("addPage",a),b("")}catch(n){console.log(n)}}const N=[{name:"الصلاحيات",link:"/dashboard/Role"},{name:"تعديل الصلاحيه",link:"#"}];return e.jsxs("div",{className:"w-100 px-3 py-0 bg-page",children:[e.jsx(E,{nav:N}),g?e.jsxs("h5",{className:"me-2 ",children:["تعديل صلاحية : ",g]}):"",e.jsx("div",{className:"w-100  d-flex align-items-center justify-content-start gap-4 fs-4  pt-4 mb-5 me-5 flex-wrap ",children:e.jsxs("div",{className:" d-flex align-items-center justify-content-start gap-2 flex-wrap    ",children:[e.jsx("input",{type:"text",value:d,onChange:s=>b(s.target.value),style:{padding:"5px",width:"250px",borderLeft:"7px solid red",borderRight:"7px solid red",borderRadius:"10px"}}),e.jsx("button",{className:"back_btn rounded ",onClick:A,children:"add page"})]})}),e.jsx(z,{component:B,sx:{maxHeight:1e3,width:"95%"},children:e.jsxs(D,{"aria-label":"simple table",children:[e.jsx(H,{children:e.jsxs(k,{sx:{backgroundColor:"#d3d9db",fontSize:"20px"},children:[e.jsx(r,{style:h,children:"اسم الصفحة"}),e.jsxs(r,{style:h,children:["عرض",e.jsx("input",{type:"checkbox",onChange:()=>{v(!y),w(y,"can_view")},style:{transform:" scale(1.5)",cursor:"pointer",marginRight:"10px"}})]}),e.jsxs(r,{style:h,children:["تعديل",e.jsx("input",{type:"checkbox",onChange:()=>{S(!f),w(f,"can_edit")},style:{transform:" scale(1.5)",cursor:"pointer",marginRight:"10px"}})]})]})}),e.jsx($,{children:m.map(s=>e.jsxs(k,{children:[e.jsx(r,{style:u,children:s.name}),e.jsx(r,{style:u,children:e.jsx("input",{type:"checkbox",checked:p[s.id]?.can_view||!1,onChange:()=>j(s.id,"can_view"),style:{transform:" scale(1.5)",cursor:"pointer"}})}),e.jsx(r,{style:u,children:e.jsx("input",{type:"checkbox",checked:p[s.id]?.can_edit||!1,onChange:()=>j(s.id,"can_edit"),style:{transform:" scale(1.5)",cursor:"pointer"}})})]},s.id))})]})}),e.jsx("button",{className:" btn btn-danger m-3  ",onClick:P,children:"Save Changes"})]})}export{V as default};
