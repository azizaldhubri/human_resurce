import{r as s,j as e,L as S,N as P,l as _,m as E,A as d}from"./index-CxioH5k5.js";import{P as C}from"./ExportPdf-DeUcesxX.js";function A(){const[o,u]=s.useState([]),[r,f]=s.useState(1),[c,j]=s.useState(3),[y,h]=s.useState(!1),p=new Date,b=p.getMonth()+1,k=p.getFullYear(),[l,N]=s.useState(""),x=()=>{if(l){const[a,n]=l.split("-");return{month:n,year:a}}return{month:b,year:k}},i=async()=>{const{month:a,year:n}=x();try{const t=await d.get(`payrolls?limit=${c}&page=${r}&month=${a}&year=${n}`);u(t.data.data),console.log(t.data.data)}catch(t){console.log(t)}},g=async()=>{const{month:a,year:n}=x();try{await d.post("update_payroll",{month:a,year:n}),i()}catch(t){console.log(t),i()}},w=async()=>{h(!0);try{await d.post("carry-forward-advances"),i()}catch(a){console.log(a)}h(!1)};s.useEffect(()=>{g()},[c,r,l]);const m=[{key:"employee.name",name:"الاسم"},{key:"basic_salary",name:"الراتب الأساسي"},{key:"total_allowances",name:"البدلات"},{key:"total_deductions",name:"الخصومات"},{key:"net_salary",name:"الراتب الصافي"},{key:"month_year",name:"مرتب شهر"}],v=[{name:"عرض المرتبات",link:"#"}];return e.jsxs(e.Fragment,{children:[y&&e.jsx(S,{}),e.jsxs("div",{className:"ps-2 pe-2 mt-2",children:[e.jsx(P,{nav:v}),e.jsxs("div",{className:"d-flex gap-3 mb-3 align-items-center",children:[e.jsx("label",{className:"fw-bold",children:"اختر الشهر:"}),e.jsx("input",{type:"month",value:l,onChange:a=>N(a.target.value),className:"form-control",style:{maxWidth:"200px"}}),e.jsx("button",{className:"btn btn-primary",onClick:g,children:"عرض"})]}),e.jsxs("div",{className:"d-flex align-items-center gap-3 mb-2",children:[e.jsx("p",{className:"m-0",children:"يجب ترحيل الأرصدة من الشهر السابق إذا لم يتم ترحيلها هذا الشهر"}),e.jsx("button",{className:"btn btn-warning",onClick:w,children:"ترحيل"})]}),e.jsx(_,{limit:c,setLimit:j,page:r,header:m,data:o,setPage:f,loading:y,edit:"",total:0,search:"name",Linksearch:o,role:""}),e.jsxs("div",{className:" d-flex gap-3 w-50 align-items-center mt-3 ",children:[e.jsx(E,{data:o,header:m}),e.jsx(C,{header:m,data:o})]})]})]})}export{A as default};
