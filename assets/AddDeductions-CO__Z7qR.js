import{r as c,A as m,j as e,L as H,N as I,F as s,a,S as v,H as F}from"./index-CxioH5k5.js";import{S as w}from"./sweetalert2.esm.all-CZCIYDgo.js";import{c as S}from"./customStylesSelect-DhMH63Ix.js";function R(){const[C,n]=c.useState(!1),[L,A]=c.useState([]),[t,r]=c.useState(""),[i,u]=c.useState(""),[x,p]=c.useState(""),[o,h]=c.useState("1"),[g,j]=c.useState(""),[d,D]=c.useState(new Date);c.useEffect(()=>{G()},[]);const G=async()=>{try{const l=await m.get("users");A(l.data.data.data)}catch(l){console.log(l)}},T=l=>{D(l)},f=l=>{w.fire({icon:"success",title:l,confirmButtonText:"حسناً"})},y=l=>{w.fire({icon:"error",title:"خطأ",text:l?.response?.data?.message||"حدث خطأ غير متوقع",confirmButtonText:"إغلاق"})},k=async()=>{n(!0);try{await m.post("deductions",{employee_id:t,deduction_type:i,amount:x}),f("تم تسجيل الخصم بنجاح"),u(""),p(""),r(null)}catch(l){console.log(l),y(l)}finally{n(!1)}},E=async()=>{n(!0);try{await m.post("absences",{employee_id:t,absence_date:d,absence_type:o,deduction_amount:o==="1"?g:0}),f("تم تسجيل الغياب بنجاح"),j(""),r(null)}catch(l){console.log(l),y(l)}finally{n(!1)}},b=L?.map(l=>({value:l.id,label:l.name})),N=l=>{r(l.value)},_=[{name:"إضافة خصم",link:"#"}];return e.jsx(e.Fragment,{children:C?e.jsx(H,{}):e.jsxs("div",{className:"px-3 py-2 border border-3",style:{minHeight:"100vh"},children:[e.jsx(I,{nav:_}),e.jsxs("div",{className:"w-100 fs-5 d-flex justify-content-center gap-lg-4 flex-wrap",children:[e.jsxs(s.Group,{className:"d-flex col-lg-5 col-md-6 col-sm-11 col-12 p-2 flex-wrap align-items-center justify-content-center",children:[e.jsx(s.Label,{className:"col-6 col-lg-3 col-md-6 col-sm-4 m-0",children:"اختر موظف"}),e.jsx(a,{lg:9,sm:8,xs:12,md:12,children:e.jsx(v,{options:b,value:t!=null?t.label:null,name:"employeeId",onChange:N,placeholder:"اختر موظف",styles:S,required:!0})})]}),e.jsxs(s.Group,{className:"d-flex col-lg-5 col-md-6 col-sm-11 col-12 p-2 flex-wrap align-items-center justify-content-center",children:[e.jsx(s.Label,{className:"col-6 col-lg-3 col-md-6 col-sm-4 m-0",children:"نوع الخصم"}),e.jsx(a,{lg:9,sm:8,xs:12,md:12,children:e.jsx(s.Control,{type:"text",placeholder:"نوع الخصم",value:i,onChange:l=>u(l.target.value)})})]}),e.jsxs(s.Group,{className:"d-flex col-lg-5 col-md-6 col-sm-11 col-12 p-2 flex-wrap align-items-center justify-content-center",children:[e.jsx(s.Label,{className:"col-6 col-lg-3 col-md-6 col-sm-4 m-0",children:"المبلغ"}),e.jsx(a,{lg:9,sm:8,xs:12,md:12,children:e.jsx(s.Control,{type:"number",placeholder:"المبلغ",value:x,onChange:l=>p(l.target.value)})})]}),e.jsx("div",{className:"d-flex col-lg-5 col-md-6 col-sm-11 col-12 p-2 align-items-center",children:e.jsx("button",{className:"btn btn-primary w-100",onClick:k,children:"إضافة الخصم"})})]}),e.jsx("h3",{className:"border-0 border-top pt-4 mt-5",children:"إضافة غياب"}),e.jsxs("div",{className:"w-100 fs-5 d-flex justify-content-center gap-lg-4 flex-wrap",children:[e.jsxs(s.Group,{className:"d-flex col-lg-5 col-md-6 col-sm-11 col-12 p-2 flex-wrap align-items-center justify-content-center",children:[e.jsx(s.Label,{className:"col-6 col-lg-3 col-md-6 col-sm-4 m-0",children:"اختر موظف"}),e.jsx(a,{lg:9,sm:8,xs:12,md:12,children:e.jsx(v,{options:b,value:t!=null?t.label:null,name:"employeeId",onChange:N,placeholder:"اختر موظف",styles:S,required:!0})})]}),e.jsxs(s.Group,{className:"d-flex col-lg-5 col-md-6 col-sm-11 col-12 p-2 flex-wrap align-items-center justify-content-center",children:[e.jsx(s.Label,{className:"col-6 col-lg-3 col-md-6 col-sm-4 m-0",children:"تاريخ الغياب"}),e.jsx(a,{lg:9,sm:8,xs:12,md:12,children:e.jsx(F,{value:d,date:d,setSelectDate:T})})]}),e.jsxs(s.Group,{className:"d-flex col-lg-5 col-md-6 col-sm-11 col-12 p-2 flex-wrap align-items-center justify-content-center",children:[e.jsx(s.Label,{className:"col-6 col-lg-3 col-md-6 col-sm-4 m-0",children:"نوع الغياب"}),e.jsx("fieldset",{children:e.jsxs(s.Group,{className:"mt-3 d-flex gap-3",children:[e.jsx(s.Check,{type:"radio",name:"absenceType",checked:o==="1",value:"1",onChange:l=>h(l.target.value)}),e.jsx(s.Label,{children:"غياب بغير إذن"}),e.jsx(s.Check,{type:"radio",name:"absenceType",value:"2",onChange:l=>h(l.target.value)}),e.jsx(s.Label,{children:"غياب مع إذن"})]})})]}),e.jsxs(s.Group,{className:"d-flex col-lg-5 col-md-6 col-sm-11 col-12 p-2 flex-wrap align-items-center justify-content-center",children:[e.jsx(s.Label,{className:"col-6 col-lg-3 col-md-6 col-sm-4 m-0",children:"المبلغ المخصوم"}),e.jsx(a,{lg:9,sm:8,xs:12,md:12,children:e.jsx(s.Control,{type:"number",placeholder:"المبلغ المخصوم",value:g,onChange:l=>j(l.target.value),disabled:o==="2"})})]})]}),e.jsx("div",{className:"w-100 d-flex align-items-center justify-content-center mt-3",children:e.jsx("button",{className:"btn btn-primary w-50",onClick:E,children:"إضافة الغياب"})})]})})}export{R as default};
