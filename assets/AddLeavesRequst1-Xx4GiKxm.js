import{q as z,r as a,s as O,t as V,j as e,e as m,F as n,a as o,S as W,H as h,v as J,A as p,U as K}from"./index-CxioH5k5.js";import{S as j}from"./sweetalert2.esm.all-CZCIYDgo.js";import{c as P}from"./customStylesSelect-DhMH63Ix.js";function le(){const y=z(),v=a.useContext(O);let b=a.useContext(V).setIsupdateNotifaction;const w=v.user.id,[X,N]=a.useState([]),[x,S]=a.useState(""),[u,D]=a.useState([]),[k,C]=a.useState(""),[Y,Z]=a.useState(!1),[r,L]=a.useState(!1),[d,g]=a.useState([]);function _(){b(s=>!s)}const R=()=>{L(!r)},f=a.useRef(null);a.useEffect(()=>{async function s(){try{const t=await p.get(`/${K}`);N(t.data.data)}catch(t){console.log(t)}}s()},[]),a.useEffect(()=>{async function s(){try{const t=await p.get("leavesType");D(t.data)}catch(t){console.log(t)}}s()},[]);const T=u&&u.map(s=>({value:s.id,label:s.name})),E=s=>{C(s)},[c,U]=a.useState(new Date),[i,F]=a.useState(new Date),G=(new Date(i)-new Date(c))/(1e3*60*60*24),q=a.useCallback(s=>{U(s)},[]),I=a.useCallback(s=>{F(s)},[]);function A(s){g(t=>[...t,...s.target.files])}function B(s){g(t=>t.filter(l=>l!==s))}function M(){f.current.click()}async function $(s){s.preventDefault();const t=new FormData;t.append("employee_id",w),t.append("leave_type_id",k.value),t.append("start_date",c),t.append("end_date",i),t.append("total_days",G),t.append("reason",x),t.append("approved_by",""),t.append("status","pending"),t.append("admin","1"),t.append("link_notification","/dashboard/LeavesRequestsManegment");for(let l=0;l<d.length;l++)t.append("files[]",d[l]);try{await p.post("leaves/add",t),y("/dashboard/Leaves/LeavesRequestsManegment"),_(),j.fire({icon:"success",text:"تم تقديم طلب الإجازة بنجاح",confirmButtonText:"حسناً"})}catch(l){console.log(l.response.data.message),j.fire({icon:"error",title:"خطأ",text:l.response?.data?.message||"رصيد الإجازة غير كافٍ'",confirmButtonText:"إغلاق"})}}return e.jsxs("div",{className:"w-100  border  border-primary   col-12 col-lg-12 col-md-12 col-sm-12 px-2 py-3   ",style:{},children:[e.jsxs("div",{className:"d-flex    w-75   fs-3     text-center align-items-center justify-content-center gap-5 ",style:{height:"50px"},children:[e.jsx(m,{to:"/dashboard",className:"link m-0  ",children:"رجوع"}),e.jsx(m,{to:"#",className:"link m-0  ",children:"عرض كل الموظفين"})]}),e.jsxs("div",{className:"w-100 d-flex col-12 col-lg-12 col-md-12 col-sm-12 align-items-center justify-content-center  flex-column    ",children:[e.jsxs("div",{className:"  mt-3  w-100    fs-5 col-12 col-lg-12 col-md-12 col-sm-12 d-flex justify-content-center gap-lg-4 align-items-center justify-content-center  flex-wrap",children:[e.jsxs(n.Group,{className:"d-flex  col-lg-5 col-md-5 col-sm-11  col-12   p-2 flex-wrap align-items-center justify-content-center",children:[e.jsx(n.Label,{className:"  col-6 col-lg-3 col-md-4 col-sm-4 m-0 col-md-12",children:"نوع الاجازة"}),e.jsx(o,{lg:9,sm:8,xs:12,md:12,children:e.jsx(W,{className:"w-100   ",name:"document_type",onChange:E,options:T,placeholder:"اختر نوع الإجازة ",styles:P,required:!0})})]}),e.jsxs(n.Group,{className:"d-flex  col-lg-5 col-md-5 col-sm-11  col-12  p-2 flex-wrap align-items-center justify-content-center",children:[e.jsx(n.Label,{className:"  col-6 col-lg-3 col-md-4 col-sm-4 m-0 col-md-8",children:" سبب الإجازة "}),e.jsx(o,{lg:9,sm:8,xs:12,md:12,children:e.jsx(n.Control,{as:"textarea","aria-label":"With textarea",name:"reason",value:x,onChange:s=>S(s.target.value),placeholder:"Description"})})]})]}),e.jsxs("div",{className:"    w-100    fs-5 col-12 col-lg-12 col-md-12 col-sm-12 d-flex justify-content-center gap-lg-4 align-items-center justify-content-center  flex-wrap",children:[e.jsxs(n.Group,{className:"d-flex  col-lg-5 col-md-5 col-sm-11  col-12  p-2 flex-wrap align-items-center justify-content-center",children:[e.jsx(n.Label,{className:"  col-6 col-lg-3 col-md-4 col-sm-4 m-0 col-md-8",children:" بداية الإجازة"}),e.jsx(o,{lg:9,sm:8,xs:12,md:12,children:e.jsx(h,{minDate:new Date,date:c,setSelectDate:q})})]}),e.jsxs(n.Group,{className:"d-flex  col-lg-5 col-md-5 col-sm-11  col-12  p-2 flex-wrap align-items-center justify-content-center",children:[e.jsx(n.Label,{className:"  col-6 col-lg-3 col-md-4 col-sm-4 m-0 col-md-8",children:" نهاية الإجازة"}),e.jsx(o,{lg:9,sm:8,xs:12,md:12,children:e.jsx(h,{minDate:c,date:c>i?i:c,setSelectDate:I})})]})]}),e.jsx("div",{className:"    w-100 mt-3   fs-5 col-12 col-lg-12 col-md-12 col-sm-12 d-flex justify-content-center gap-lg-4 align-items-center justify-content-center  flex-wrap",children:e.jsx(n.Group,{className:"d-flex  col-lg-5 col-md-5 col-sm-11  col-12  p-2 flex-wrap align-items-center justify-content-center",children:e.jsx(o,{lg:9,sm:8,xs:12,md:12,children:e.jsx(n.Control,{ref:f,hidden:!0,type:"file",multiple:!0,onChange:A})})})}),e.jsx("div",{className:"w-100   mt-2 ",children:e.jsx("div",{className:"   me-2   pe-5   d-flex   gap-lg-4 align-items-start justify-content-start  flex-wrap  ",onClick:M,style:{width:"100px"},children:e.jsx("button",{className:" cursor-pointer border-0   fs-4   ",children:" +المرفقات"})})}),e.jsx("div",{className:"   mt-3 bg-white d-flex gap-2 w-75  rounded pe-3 ps-3  bg-dark ",children:d&&d.map((s,t)=>e.jsxs("div",{className:"  position-relative mt-2   ",children:[J.map((l,H)=>e.jsx("div",{children:l.src_type==s.type&&e.jsx("div",{className:"d-flex align-items-center justify-content-start flex-column ",children:e.jsx("img",{src:l.type=="img"?`${URL.createObjectURL(s)}`:` ${l.pathimg}`,width:"30px",alt:""})})},H)),e.jsx("div",{style:{cursor:"pointer"},className:"position-absolute  top-0 end-0 bg-danger rounded text-white ",children:e.jsx("p",{className:"  m-0",onClick:()=>B(s),children:"x"})}),e.jsx("p",{className:"m-0",style:{fontSize:"10px"},children:s.name})]},t))}),e.jsxs("div",{className:" d-flex  m-2 gap-2 pt-4 ",style:{borderTop:"2px solid black",width:"80%"},children:[e.jsx("div",{className:"d-flex align-items-center border    ",style:{width:"50px",height:"20px",borderRadius:"10px",background:r?"#C9BE62 ":"gray"},children:e.jsx("button",{onClick:R,style:{marginRight:r?"50%":"0",padding:"12px",borderRadius:"100%",fontSize:"16px",background:r?"#EAC117":"white",border:"0"}})}),e.jsx("h5",{children:"أقر بأن الطلب تم بمعرفتي ومسؤوليتي"})]}),e.jsxs("div",{className:"w-100 d-flex justify-content-center gap-3 p-3 ",children:[e.jsx("button",{className:"p-1 ps-2 pe-2 rounded text-black ",style:{background:"		#893BFF"},onClick:$,children:"حفظ"}),e.jsx(m,{to:"/dashboard/documents",className:"p-1 ps-2 pe-2 rounded text-black",style:{background:"yellow"},children:"رجوع"})]})]})]})}export{le as default};
